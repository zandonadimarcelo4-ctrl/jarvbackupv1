==========================================================
  PitronIA + Open WebUI Launcher
==========================================================
[DEBUG] Trace habilitado.

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "ROOT=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "VENV_DIR=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "VENV_ACTIVATE=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent\Scripts\activate.bat" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "WEBUI_DIR=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "BACKEND_DIR=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "CUSTOM_BACKEND_DIR=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\fusion_core" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "CUSTOM_BACKEND_APP=fusion_core.pitron_fusion_runtime:app" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "BACKEND_WORKDIR=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "BACKEND_APP=open_webui.main:app" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "BACKEND_TITLE=Open WebUI Backend" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>if exist "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\fusion_core" (
set "BACKEND_WORKDIR=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\fusion_core"  
 set "BACKEND_APP=fusion_core.pitron_fusion_runtime:app"  
 set "BACKEND_TITLE=Pitron Fusion Runtime"  
 echo [INFO] Backend personalizado localizado em e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend. 
)  else (
echo [WARN] Backend personalizado nao encontrado; esperado em e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\fusion_core.  
 echo [WARN] Usando backend padrao: open_webui.main:app. 
) 
[WARN] Backend personalizado nao encontrado; esperado em e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\fusion_core.
[WARN] Usando backend padrao: open_webui.main:app.

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "NODE_MIN_VERSION=18" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "PYTHON_BACKEND=" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "ENABLE_BACKEND_TUNNEL=" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "WEB_MODE=" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "ENABLE_WEBSOCKET_SUPPORT=false" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "WEBSOCKET_MANAGER=" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>set "CMD_EXE=C:\Windows\system32\cmd.exe" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>if not defined CMD_EXE set "CMD_EXE=C:\Windows\System32\cmd.exe" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>if not exist "C:\Windows\system32\cmd.exe" set "CMD_EXE=cmd.exe" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>REM --------------------------------------------------------------------------- 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>REM  Finaliza janelas antigas para garantir reload do backend/frontend 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>REM --------------------------------------------------------------------------- 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>for /F "tokens=2 delims=," %P in ('tasklist /FI "WINDOWTITLE eq Pitron WebUI Backend" /FI "IMAGENAME eq python.exe" /NH /FO CSV 2>nul') do (if not "%P" == "" taskkill /PID %~P /F  1>nul 2>nul ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>for /F "tokens=2 delims=," %P in ('tasklist /FI "WINDOWTITLE eq Pitron Fusion Runtime" /FI "IMAGENAME eq python.exe" /NH /FO CSV 2>nul') do (if not "%P" == "" taskkill /PID %~P /F  1>nul 2>nul ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>for /F "tokens=2 delims=," %P in ('tasklist /FI "WINDOWTITLE eq Pitron WebUI Frontend" /FI "IMAGENAME eq cmd.exe" /NH /FO CSV 2>nul') do (if not "%P" == "" taskkill /PID %~P /F  1>nul 2>nul ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>for /F "tokens=2 delims=," %P in ('tasklist /FI "WINDOWTITLE eq Tunnelmole UI 5173" /FI "IMAGENAME eq cmd.exe" /NH /FO CSV 2>nul') do (if not "%P" == "" taskkill /PID %~P /F  1>nul 2>nul ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>for /F "tokens=2 delims=," %P in ('tasklist /FI "WINDOWTITLE eq Tunnelmole API 8000" /FI "IMAGENAME eq cmd.exe" /NH /FO CSV 2>nul') do (if not "%P" == "" taskkill /PID %~P /F  1>nul 2>nul ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>if not exist "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34" (
echo [ERRO] Diretorio do Open WebUI nao encontrado: e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34  
 pause 
 exit /b 1 
) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13>pushd "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34"   1>nul  || (
echo [ERRO] Falha ao acessar diretorio do WebUI.  
 pause 
 exit /b 1 
) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>for /F "tokens=*" %N in ('node -v 2>nul') do set "NODE_VERSION=%N" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "NODE_VERSION=v24.11.0" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if not defined NODE_VERSION (
echo [ERRO] Node.js nao encontrado no PATH. Instale Node 18 ou superior.  
 popd  1>nul  
 pause 
 exit /b 1 
) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>echo [OK] Node.js detectado: v24.11.0 
[OK] Node.js detectado: v24.11.0

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "NPM_INSTALL_CMD=npm install --legacy-peer-deps --force" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if exist "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent\Scripts\python.exe" (set "PYTHON_BACKEND=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent\Scripts\python.exe" )  else (
set "PYTHON_BACKEND=python"  
 echo [WARN] Python especifico do ambiente virtual nao encontrado. Usarei interpretador global. 
) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if /I "" == "dev" (set "WEB_MODE=dev" )  else (set "WEB_MODE=prod" ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if /I "prod" == "prod" (set "ENABLE_BACKEND_TUNNEL=1" )  else if /I "" == "1" (set "ENABLE_BACKEND_TUNNEL=1" ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>echo [INFO] Web mode selected: prod 
[INFO] Web mode selected: prod

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>mkdir logs  2>nul 1>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if not exist "logs\pitron_core.log" (type nul  1>"logs\pitron_core.log" ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "PYTHONPATH=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if /I not "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" == "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\" (set "PYTHONPATH=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\;e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if not exist "node_modules" (
echo [INFO] Instalando dependencias do frontend (npm install)...  
 call npm install --legacy-peer-deps --force  
 if errorlevel 1 (
echo [ERRO] Falha ao executar npm install.  
 popd  1>nul  
 pause 
 exit /b 1 
) 
)  else (echo [INFO] Dependencias do frontend ja presentes (node_modules localizado). ) 
[INFO] Dependencias do frontend ja presentes (node_modules localizado).

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if /I "prod" == "prod" (call :EnsureFrontendBuild "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34" ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "FRONT_PATH=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "BUILD_PATH=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\build" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if defined PITRON_FORCE_BUILD (set "NEED_BUILD=1" )  else if not exist "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\build\index.html" (set "NEED_BUILD=1" )  else (set "NEED_BUILD=" ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if defined NEED_BUILD (
echo [INFO] Gerando build estatico do frontend (npm run build)... Isso pode levar alguns minutos.  
 call npm run build  
 if errorlevel 1 (
echo [ERRO] Falha ao executar npm run build. Verifique os logs acima.  
 popd  1>nul  
 pause 
 exit /b 1 
)  
 echo [OK] Build estatico disponivel em e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\build. 
)  else (echo [INFO] Build estatico encontrado em e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\build. ) 
[INFO] Build estatico encontrado em e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\build.

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "NEED_BUILD=" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>goto :EOF 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>for /F "tokens=5" %p in ('netstat -ano | findstr :8000') do taskkill /PID %p /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 0 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 0 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 0 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 0 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 0 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 0 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 31576 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 31576 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 31576 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 31576 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>taskkill /PID 31576 /F  1>nul 2>nul 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>call :LaunchBackend "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" "open_webui.main:app" "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent\Scripts\python.exe" "Open WebUI Backend" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "BACKEND_PATH=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "BACKEND_APP=open_webui.main:app" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "PY_BACKEND=e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent\Scripts\python.exe" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>set "BACKEND_WINDOW=Open WebUI Backend" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if not defined BACKEND_WINDOW set "BACKEND_WINDOW=Pitron WebUI Backend" 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if not exist "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" (
echo [ERRO] Diretorio do backend nao encontrado: e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend  
 exit /b 1 
) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>echo [INFO] Iniciando backend (Open WebUI Backend) em nova janela... 
[INFO] Iniciando backend (Open WebUI Backend) em nova janela...

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>if exist "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent\Scripts\python.exe" (start "Open WebUI Backend" /d "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\agent\Scripts\python.exe" -m uvicorn open_webui.main:app --host 0.0.0.0 --port 8000 --reload --log-level info )  else (start "Open WebUI Backend" /d "e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34\backend" "C:\Windows\system32\cmd.exe" /k "python -m uvicorn open_webui.main:app --host 0.0.0.0 --port 8000 --reload --log-level info" ) 

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>goto :EOF 
. was unexpected at this time.

e:\PitronStorage\codeiaprendi - Copy\pitronia_FIXED_v13\open-webui\open-webui-0.6.34>    echo [INFO] Modo PROD: frontend estatico servido pelo backend (porta 8000).
